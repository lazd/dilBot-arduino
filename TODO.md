### Refactoring

* enums for state ints
* break charging routines into functions
* be less globalvariably
* capitalized comments
